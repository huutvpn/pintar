<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Digital Pendidikan Agama Islam</title>
    <style>
        :root {
            --primary: #059669; /* Emerald Green */
            --primary-dark: #047857;
            --secondary: #fbbf24; /* Amber */
            --bg: #f3f4f6;
            --white: #ffffff;
            --text: #1f2937;
            --danger: #ef4444;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Layout & Container */
        .container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 0 1rem;
            flex: 1;
        }

        header {
            text-align: center;
            margin-bottom: 2rem;
        }

        h1 {
            color: var(--primary);
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--primary-dark);
        }

        /* Cards */
        .card {
            background: var(--white);
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
            transition: transform 0.2s;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text);
        }

        input, select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.2s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* Buttons */
        .btn {
            display: inline-block;
            background-color: var(--primary);
            color: var(--white);
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            text-align: center;
            transition: background 0.2s;
        }

        .btn:hover {
            background-color: var(--primary-dark);
        }

        .btn-secondary {
            background-color: #6b7280;
            margin-top: 10px;
        }

        .btn-small {
            width: auto;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }

        /* Quiz UI */
        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid var(--bg);
            padding-bottom: 1rem;
        }

        .progress-badge {
            background: var(--secondary);
            color: #78350f;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .sound-btn {
            background: #e0f2fe;
            color: #0369a1;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .question-text {
            font-size: 1.25rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
        }

        .options-grid {
            display: grid;
            gap: 1rem;
        }

        .option-label {
            display: flex;
            align-items: center;
            padding: 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .option-label:hover {
            background-color: #f0fdf4;
            border-color: var(--primary);
        }

        .option-label input {
            width: auto;
            margin-right: 1rem;
        }

        /* Results */
        .score-circle {
            width: 150px;
            height: 150px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0 auto 2rem;
            box-shadow: 0 10px 15px -3px rgba(5, 150, 105, 0.4);
        }

        .score-number {
            font-size: 3rem;
            font-weight: bold;
        }

        .score-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Admin Dashboard */
        .admin-controls {
            margin-bottom: 1rem;
            text-align: right;
        }
        
        .class-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            overflow-x: auto;
            padding-bottom: 0.5rem;
        }

        .tab-btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--primary);
            background: white;
            color: var(--primary);
            border-radius: 20px;
            cursor: pointer;
            white-space: nowrap;
        }

        .tab-btn.active {
            background: var(--primary);
            color: white;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        th, td {
            text-align: left;
            padding: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
        }

        th {
            background-color: #f9fafb;
            font-weight: 600;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: #f0fdf4;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #bbf7d0;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        /* Utilities */
        .hidden {
            display: none !important;
        }

        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--danger);
            color: white;
            padding: 1rem 2rem;
            border-radius: 8px;
            box-shadow: 0 10px 15px rgba(0,0,0,0.2);
            transform: translateY(150%);
            transition: transform 0.3s ease-out;
            z-index: 1000;
        }

        .toast.show {
            transform: translateY(0);
        }

        .footer-link {
            text-align: center;
            margin-top: 2rem;
            font-size: 0.8rem;
            color: #6b7280;
            cursor: pointer;
            text-decoration: underline;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .container { padding: 0 0.5rem; margin: 1rem auto; }
            .card { padding: 1.5rem; }
            h1 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>üïå Quiz Digital PAI</h1>
            <p>Aplikasi Latihan Soal Pendidikan Agama Islam</p>
        </header>

        <!-- 1. LOGIN SECTION -->
        <section id="login-section" class="card">
            <h2>Selamat Datang Siswa</h2>
            <p style="margin-bottom: 1.5rem; color: #666;">Silakan isi data diri untuk memulai kuis.</p>
            
            <form id="login-form">
                <div class="form-group">
                    <label for="student-name">Nama Lengkap</label>
                    <input type="text" id="student-name" placeholder="Contoh: Ahmad Dahlan" required>
                </div>
                
                <div class="form-group">
                    <label for="student-class">Pilih Kelas</label>
                    <select id="student-class" required>
                        <option value="" disabled selected>-- Pilih Kelas --</option>
                        <option value="3A">Kelas 3A</option>
                        <option value="3B">Kelas 3B</option>
                        <option value="4A">Kelas 4A</option>
                        <option value="4B">Kelas 4B</option>
                    </select>
                </div>

                <button type="submit" class="btn">Mulai Mengerjakan</button>
            </form>
        </section>

        <!-- 2. QUIZ SECTION -->
        <section id="quiz-section" class="card hidden">
            <div class="quiz-header">
                <span id="quiz-class-display" style="font-weight: bold; color: var(--primary);">Kelas X</span>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span id="question-progress" class="progress-badge">Soal 1/10</span>
                    <button type="button" class="sound-btn" id="replay-sound-btn" title="Baca Ulang Soal">üîä</button>
                </div>
            </div>

            <div class="question-container">
                <p id="question-text" class="question-text">Loading soal...</p>
                <div id="options-container" class="options-grid">
                    <!-- Options injected via JS -->
                </div>
            </div>

            <div style="margin-top: 2rem; display: flex; justify-content: flex-end;">
                <button id="next-btn" class="btn btn-small" style="width: auto;">Soal Selanjutnya ‚û°Ô∏è</button>
            </div>
        </section>

        <!-- 3. RESULT SECTION -->
        <section id="result-section" class="card hidden">
            <h2>Hasil Quiz Anda</h2>
            <div class="score-circle">
                <span id="final-score" class="score-number">0</span>
                <span class="score-label">Nilai Akhir</span>
            </div>
            
            <p id="result-message" style="text-align: center; font-weight: 600; margin-bottom: 2rem;">
                Terima kasih telah mengerjakan.
            </p>

            <div style="background: #eff6ff; padding: 1rem; border-radius: 8px; border-left: 4px solid #3b82f6;">
                <p><strong>Nama:</strong> <span id="result-name">-</span></p>
                <p><strong>Kelas:</strong> <span id="result-class">-</span></p>
                <p><strong>Waktu:</strong> <span id="result-time">-</span></p>
            </div>

            <button onclick="location.reload()" class="btn" style="margin-top: 2rem;">Kembali ke Halaman Utama</button>
        </section>

        <!-- 4. ADMIN DASHBOARD SECTION -->
        <section id="admin-section" class="card hidden">
            <div class="admin-controls">
                <button id="logout-admin-btn" class="btn btn-small btn-secondary">Keluar Mode Guru</button>
                <button id="reset-data-btn" class="btn btn-small" style="background-color: var(--danger);">Hapus Semua Data</button>
            </div>
            
            <h2>Rekapitulasi Nilai Per Kelas</h2>
            
            <div class="class-tabs" id="class-tabs">
                <button class="tab-btn active" data-class="3A">Kelas 3A</button>
                <button class="tab-btn" data-class="3B">Kelas 3B</button>
                <button class="tab-btn" data-class="4A">Kelas 4A</button>
                <button class="tab-btn" data-class="4B">Kelas 4B</button>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <p>Jumlah Siswa</p>
                    <div id="stat-count" class="stat-value">0</div>
                </div>
                <div class="stat-card">
                    <p>Rata-rata Kelas</p>
                    <div id="stat-avg" class="stat-value">0</div>
                </div>
                <div class="stat-card">
                    <p>Nilai Tertinggi</p>
                    <div id="stat-high" class="stat-value">0</div>
                </div>
            </div>

            <div style="overflow-x: auto;">
                <table id="result-table">
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>Nama Siswa</th>
                            <th>Nilai</th>
                            <th>Tanggal & Waktu</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Data rows -->
                    </tbody>
                </table>
                <p id="empty-state" style="text-align: center; padding: 2rem; color: #888;">Belum ada data siswa yang mengerjakan di kelas ini.</p>
            </div>
        </section>

        <div class="footer-link" id="admin-trigger">Login Guru (Lihat Nilai)</div>
    </div>

    <!-- TOAST NOTIFICATION -->
    <div id="toast" class="toast">Pesan notifikasi</div>

    <script>
        // --- DATA SOAL (10 Soal per Kelas) ---
        const quizData = {
            '3A': [
                { q: "Rukun Islam yang pertama adalah?", options: ["Sholat", "Puasa", "Syahadat", "Zakat"], a: 2 },
                { q: "Apa arti dari Asyhadu an Laa Ilaha Illallah?", options: ["Aku bersaksi tiada Tuhan selain Allah", "Aku bersaksi Muhammad utusan Allah", "Aku bersaksi orang mukmin berteman", "Aku bersaksi malaikat itu ada"], a: 0 },
                { q: "Berapa jumlah rukun Islam?", options: ["4", "5", "6", "3"], a: 1 },
                { q: "Sholat wajib dalam sehari semalam berjumlah?", options: ["3 waktu", "4 waktu", "5 waktu", "6 waktu"], a: 2 },
                { q: "Bulan puasa Ramadhan adalah bulan ke?", options: ["7", "8", "9", "10"], a: 2 },
                { q: "Membayar zakat fitrah waktunya pada bulan?", options: ["Muharram", "Ramadhan", "Sya'ban", "Rajab"], a: 1 },
                { q: "Haji wajib dilaksanakan bagi mereka yang mampu ke?", options: ["Madinah", "Mekkah", "Palestina", "Mesir"], a: 1 },
                { q: "Tata cara bersuci disebut?", options: ["Thaharah", "Wudhu", "Mandi", "Suci"], a: 0 },
                { q: "Air yang suci lagi menyucikan disebut?", options: ["Air musta'mal", "Air mutanajis", "Air suci", "Air mutlak"], a: 3 },
                { q: "Malaikat yang bertugas mencatat amal baik adalah?", options: ["Jibril", "Mikail", "Raqib", "Atid"], a: 2 }
            ],
            '3B': [
                { q: "Kita harus beriman kepada Malaikat Allah. Jumlah malaikat itu?", options: ["Sedikit", "Banyak", "Hanya 10", "Tidak terhitung jumlahnya"], a: 3 },
                { q: "Malaikat Jibril bertugas menyampaikan?", options: ["Rezeki", "Wahyu", "Hujan", "Meniup sangkakala"], a: 1 },
                { q: "Malaikat Mikail bertugas mengatur?", options: ["Rezeki dan hujan", "Kematian", "Wahyu", "Ibadah haji"], a: 0 },
                { q: "Malaikat yang mencabut nyawa adalah?", options: ["Izrail", "Israfil", "Munkar", "Nakir"], a: 0 },
                { q: "Malaikat Malik adalah penjaga?", options: ["Surga", "Neraka", "Arsy", "Langit"], a: 1 },
                { q: "Rukun Iman yang ketiga adalah?", options: ["Iman kepada Malaikat", "Iman kepada Kitab", "Iman kepada Rasul", "Iman kepada Qada dan Qadar"], a: 0 },
                { q: "Kitab Allah yang diturunkan kepada Nabi Musa adalah?", options: ["Zabur", "Taurat", "Injil", "Al-Quran"], a: 1 },
                { q: "Nabi Allah yang terakhir adalah?", options: ["Nabi Isa AS", "Nabi Ibrahim AS", "Nabi Muhammad SAW", "Nabi Musa AS"], a: 2 },
                { q: "Kitab suci umat Islam adalah?", options: ["Taurat", "Injil", "Zabur", "Al-Quran"], a: 3 },
                { q: "Malaikat Ridwan adalah penjaga?", options: ["Surga", "Neraka", "Pintu langit", "Arasy"], a: 0 }
            ],
            '4A': [
                { q: "Sifat wajib bagi Rasul adalah?", options: ["Jujur", "Dusta", "Bodoh", "Lalai"], a: 0 },
                { q: "Lawan kata dari Sifat Wajib adalah?", options: ["Mustahil", "Jaiz", "Wajib", "Sunnah"], a: 0 },
                { q: "Nabi Muhammad SAW menerima wahyu pertama di gua?", options: ["Hira", "Tsur", "Nur", "Safa"], a: 0 },
                { q: "Istri pertama Nabi Muhammad SAW adalah?", options: ["Aisyah", "Khadijah", "Hafshah", "Zainab"], a: 1 },
                { q: "Perang Badar terjadi pada tahun ke?", options: ["1 Hijriah", "2 Hijriah", "3 Hijriah", "5 Hijriah"], a: 1 },
                { q: "Tahun di mana Nabi Muhammad SAW hijrah ke Madinah disebut?", options: ["Tahun Gajah", "Tahun Hijriah", "Tahun Kesedihan", "Tahun Kemenangan"], a: 1 },
                { q: "Sahabat yang pertama masuk Islam adalah?", options: ["Ali bin Abi Thalib", "Abu Bakar", "Umar bin Khattab", "Usman bin Affan"], a: 0 },
                { q: "Nabi Muhammad SAW wafat pada usia?", options: ["60 tahun", "62 tahun", "63 tahun", "65 tahun"], a: 2 },
                { q: "Ibadah haji dilaksanakan pada bulan?", options: ["Ramadhan", "Syawal", "Dzulhijjah", "Muharram"], a: 2 },
                { q: "Tanah suci tempat Nabi Ibrahim mendirikan Ka'bah adalah?", options: ["Madinah", "Mekkah", "Jerusalem", "Jeddah"], a: 1 }
            ],
            '4B': [
                { q: "Apa hukum makan makanan yang halal?", options: ["Wajib", "Haram", "Makruh", "Jaiz"], a: 0 },
                { q: "Daging babi hukumnya adalah?", options: ["Halal", "Makruh", "Haram", "Jaiz"], a: 2 },
                { q: "Memakai pakaian sopan adalah bagian dari akhlak?", options: ["Terpuji (Mulia)", "Tercela", "Buruk", "Bodoh"], a: 0 },
                { q: "Sikap kita jika berbuat salah adalah?", options: ["Membela diri", "Meminta maaf", "Lari", "Marah-marah"], a: 1 },
                { q: "Berbakti kepada orang tua adalah perintah Allah dalam surat?", options: ["Al-Ikhlas", "An-Nisa", "Al-Isra", "Al-Fatihah"], a: 2 },
                { q: "Tetangga yang haknya wajib kita jaga disebut?", options: ["Haqqul Muslim", "Haqqul Jar", "Haqqul Walidain", "Haqqul Anak"], a: 1 },
                { q: "Menyakiti hati teman dengan perkataan kasar adalah akhlak?", options: ["Terpuji", "Tercela", "Wajib", "Sunnah"], a: 1 },
                { q: "Allah menyukai orang yang?", options: ["Sombong", "Kikir", "Tawadhu (Rendah Hati)", "Pembohong"], a: 2 },
                { q: "Memakai emas bagi laki-laki dewasa hukumnya adalah?", options: ["Sunnah", "Wajib", "Haram", "Mubah"], a: 2 },
                { q: "Jujur dalam perkataan dan perbuatan adalah sikap?", options: ["Munafik", "Mukmin", "Kafir", "Durhaka"], a: 1 }
            ]
        };

        // --- STATE MANAGEMENT ---
        let currentClass = '';
        let currentName = '';
        let currentQuestionIndex = 0;
        let score = 0;
        let quizInProgress = false;

        // --- DOM ELEMENTS ---
        const loginSection = document.getElementById('login-section');
        const quizSection = document.getElementById('quiz-section');
        const resultSection = document.getElementById('result-section');
        const adminSection = document.getElementById('admin-section');
        
        const loginForm = document.getElementById('login-form');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const nextBtn = document.getElementById('next-btn');
        const progressBar = document.getElementById('question-progress');
        const replaySoundBtn = document.getElementById('replay-sound-btn');
        const quizClassDisplay = document.getElementById('quiz-class-display');

        // --- TEXT TO SPEECH SETUP ---
        const synth = window.speechSynthesis;
        let voices = [];

        function loadVoices() {
            voices = synth.getVoices();
        }

        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = loadVoices;
        }

        function speakQuestion(text) {
            // Hentikan suara sebelumnya jika ada
            if (synth.speaking) {
                synth.cancel();
            }

            const utterThis = new SpeechSynthesisUtterance(text);
            // Coba cari suara Bahasa Indonesia
            const indoVoice = voices.find(v => v.lang.includes('id-ID'));
            if (indoVoice) utterThis.voice = indoVoice;
            
            utterThis.rate = 0.9; // Kecepatan sedikit lebih lambat agar jelas
            utterThis.pitch = 1;
            synth.speak(utterThis);
        }

        // --- LOGIC: LOGIN & VALIDATION ---
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const nameInput = document.getElementById('student-name').value.trim();
            const classInput = document.getElementById('student-class').value;

            if (!nameInput || !classInput) {
                showToast("Nama dan Kelas harus diisi!");
                return;
            }

            // Cek apakah sudah mengerjakan
            const storedData = JSON.parse(localStorage.getItem('pai_quiz_results') || '[]');
            const hasTaken = storedData.find(student => student.name.toLowerCase() === nameInput.toLowerCase() && student.class === classInput);

            if (hasTaken) {
                showToast(`Maaf, ${nameInput} dari kelas ${classInput} sudah mengerjakan kuis ini.`);
                return;
            }

            // Start Quiz
            currentName = nameInput;
            currentClass = classInput;
            startQuiz();
        });

        function startQuiz() {
            loginSection.classList.add('hidden');
            quizSection.classList.remove('hidden');
            quizClassDisplay.textContent = `Kelas ${currentClass}`;
            currentQuestionIndex = 0;
            score = 0;
            quizInProgress = true;
            loadQuestion();
        }

        // --- LOGIC: QUIZ MECHANISM ---
        function loadQuestion() {
            const questions = quizData[currentClass];
            const currentQ = questions[currentQuestionIndex];

            // Update UI
            progressBar.textContent = `Soal ${currentQuestionIndex + 1}/${questions.length}`;
            questionText.textContent = currentQ.q;
            
            // Render Options
            optionsContainer.innerHTML = '';
            currentQ.options.forEach((opt, index) => {
                const label = document.createElement('label');
                label.className = 'option-label';
                label.innerHTML = `
                    <input type="radio" name="answer" value="${index}">
                    <span>${opt}</span>
                `;
                optionsContainer.appendChild(label);
            });

            // Auto Sound
            setTimeout(() => {
                speakQuestion(currentQ.q);
            }, 500);

            nextBtn.disabled = true;
            nextBtn.style.opacity = '0.5';
            nextBtn.textContent = (currentQuestionIndex === questions.length - 1) ? "Selesai" : "Soal Selanjutnya ‚û°Ô∏è";

            // Enable next button when option selected
            const radios = document.querySelectorAll('input[name="answer"]');
            radios.forEach(radio => {
                radio.addEventListener('change', () => {
                    nextBtn.disabled = false;
                    nextBtn.style.opacity = '1';
                    // Stop sound when user interacts
                    if(synth.speaking) synth.cancel();
                });
            });
        }

        nextBtn.addEventListener('click', () => {
            const selectedOption = document.querySelector('input[name="answer"]:checked');
            if (!selectedOption) return;

            // Check Answer
            const answerVal = parseInt(selectedOption.value);
            const correctAnswer = quizData[currentClass][currentQuestionIndex].a;
            if (answerVal === correctAnswer) {
                score++;
            }

            currentQuestionIndex++;

            if (currentQuestionIndex < quizData[currentClass].length) {
                loadQuestion();
            } else {
                finishQuiz();
            }
        });

        replaySoundBtn.addEventListener('click', () => {
            const q = quizData[currentClass][currentQuestionIndex].q;
            speakQuestion(q);
        });

        // --- LOGIC: FINISH & SAVE ---
        function finishQuiz() {
            quizInProgress = false;
            quizSection.classList.add('hidden');
            resultSection.classList.remove('hidden');

            const finalScore = (score / 10) * 100; // Karena 10 soal
            document.getElementById('final-score').textContent = finalScore;
            document.getElementById('result-name').textContent = currentName;
            document.getElementById('result-class').textContent = currentClass;
            
            const now = new Date();
            document.getElementById('result-time').textContent = now.toLocaleString('id-ID');

            // Pesan berdasarkan nilai
            const msg = document.getElementById('result-message');
            if (finalScore === 100) msg.textContent = "Masya Allah! Sempurna! Pertahankan prestasimu.";
            else if (finalScore >= 80) msg.textContent = "Alhamdulillah! Bagus sekali.";
            else if (finalScore >= 60) msg.textContent = "Cukup bagus, tingkatkan lagi belajarnya.";
            else msg.textContent = "Jangan menyerah, ayo belajar lebih giat lagi!";

            // SAVE TO LOCAL STORAGE
            const record = {
                name: currentName,
                class: currentClass,
                score: finalScore,
                timestamp: now.toISOString()
            };

            const storedData = JSON.parse(localStorage.getItem('pai_quiz_results') || '[]');
            storedData.push(record);
            localStorage.setItem('pai_quiz_results', JSON.stringify(storedData));

            // Stop any remaining audio
            if(synth.speaking) synth.cancel();
        }

        // --- ADMIN DASHBOARD LOGIC ---
        const adminTrigger = document.getElementById('admin-trigger');
        const adminSection = document.getElementById('admin-section');
        
        // Simple "Admin" (No password for demo, just click)
        adminTrigger.addEventListener('click', () => {
            adminSection.classList.remove('hidden');
            loginSection.classList.add('hidden');
            resultSection.classList.add('hidden');
            quizSection.classList.add('hidden');
            loadAdminData('3A');
        });

        document.getElementById('logout-admin-btn').addEventListener('click', () => {
            adminSection.classList.add('hidden');
            loginSection.classList.remove('hidden');
            document.getElementById('student-name').value = '';
            document.getElementById('student-class').value = '';
        });

        document.getElementById('reset-data-btn').addEventListener('click', () => {
            if(confirm("Yakin ingin menghapus semua data nilai siswa? Tindakan ini tidak bisa dibatalkan.")) {
                localStorage.removeItem('pai_quiz_results');
                loadAdminData('3A'); // Refresh UI
                showToast("Semua data berhasil dihapus.");
            }
        });

        // Tab Switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                // Remove active class
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                // Add active to clicked
                e.target.classList.add('active');
                // Load data
                loadAdminData(e.target.dataset.class);
            });
        });

        function loadAdminData(className) {
            const storedData = JSON.parse(localStorage.getItem('pai_quiz_results') || '[]');
            const classData = storedData.filter(d => d.class === className);

            const tableBody = document.querySelector('#result-table tbody');
            const emptyState = document.getElementById('empty-state');
            tableBody.innerHTML = '';

            // Stats
            document.getElementById('stat-count').textContent = classData.length;
            
            if (classData.length > 0) {
                const totalScore = classData.reduce((sum, item) => sum + item.score, 0);
                const avg = (totalScore / classData.length).toFixed(1);
                const max = Math.max(...classData.map(item => item.score));

                document.getElementById('stat-avg').textContent = avg;
                document.getElementById('stat-high').textContent = max;
                
                emptyState.style.display = 'none';

                // Sort by highest score
                classData.sort((a, b) => b.score - a.score);

                classData.forEach((item, index) => {
                    const row = `<tr>
                        <td>${index + 1}</td>
                        <td>${item.name}</td>
                        <td><span style="font-weight:bold; color: ${item.score >= 70 ? 'green' : 'red'}">${item.score}</span></td>
                        <td style="font-size: 0.85rem;">${new Date(item.timestamp).toLocaleString('id-ID')}</td>
                    </tr>`;
                    tableBody.innerHTML += row;
                });
                document.getElementById('result-table').classList.remove('hidden');
            } else {
                document.getElementById('stat-avg').textContent = '0';
                document.getElementById('stat-high').textContent = '0';
                emptyState.style.display = 'block';
                document.getElementById('result-table').classList.add('hidden');
            }
        }

        // --- UTILS ---
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

    </script>
</body>
</html>
